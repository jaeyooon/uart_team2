<meta charset="UTF-8">
<style>
th, td, h6 {
	color: #22333b;
}

.section {
width: 85%;
margin: 0 auto;
}

.left {
	width: 24%;
	background: #edf2fb;
}

.secondtbl_td {
	background: #edf2fb;
}

#cancel_div {
	display: flex;
    justify-content: center;
    align-items: center;
    width: 100%; 
}

#cancelfail{
 	z-index: 10000;
 }


</style>
<script>
function cancelimpl() {
	var custid = '[[${session.logincust.custid}]]';
	var orderlistid = $('#getorderlistid').text();
	intorderlistid = Number(orderlistid);
	//alert(intorderlistid);
	
	/* ì·¨ì†Œê°€ëŠ¥ì¼ì¸ì§€ ë¹„êµ */
	var pcandate = $('#possible_candate').val();
	pcandate = new Date(pcandate); // ë¬¸ìì—´ ë‚ ì§œí˜•ìœ¼ë¡œ ë³€í™˜
	//alert(pcandate);
	
	var today = new Date();
	
	if(pcandate < today) {
		$('#cancelfail').modal('show');
	}
	else {
	
		$.ajax({
			url:'/order/cancel',
			async:false,
			data:
			{
				'custid':custid,
				'orderlistid':intorderlistid
			},
			success : function() {
				console.log('success')
				location.href='/order/detail?id='+custid
			}
		}); 
	}
}

function getFormatDate(date) {
	var year = date.getFullYear();	
	var month = (1 + date.getMonth());
	month = month >= 10 ? month : '0' + month;
	var day = date.getDate();
	day = day >=10 ? day : '0' + day;
	return year + '.' + month + '.' + day;
}

$(document).ready(function(){
	var today = getFormatDate(new Date());
	//alert(today);
	
	$('#candate').text(today);
});

</script>

<div class="site-section">
		<div class="container">
			<div class="row mb-5">
				<div class="col-md-12 mb-5">
				  <section class="section">
				  				  <h4 class="text-black" style="margin-bottom: 50px; margin-left: -30px">ì˜ˆë§¤/ê²°ì œ ë‚´ì—­</h4>
				  
				  <h6 style="margin-bottom: 20px;">ğŸ”–ì˜ˆë§¤ë‚´ì—­</h6>
				  <input id="possible_candate" type="hidden" th:value="${#dates.format(orderinfo.candate,'yyyy.MM.dd')}">
				  
				  <!-- table 1 -->
				  <table class="table table-bordered table-sm">
					  <thead>
					    <tr>
					      <th th:text="${orderdetail.item_itemname}" colspan="2" style="color:#1d4e89;"></th>
					    </tr>
					  </thead>
					  <tbody>
					    <tr>
					      <td class="left">ì˜ˆë§¤ì</td>
					      <td th:text="${orderinfo.cust_cname}">
					      </td>
					    </tr>
					    <tr>
					      <td class="left">ì˜ˆë§¤ë²ˆí˜¸</td>
					      <td id="getorderlistid" th:text="${orderdetail.orderlistid}"></td>
					    </tr>
					    <tr>
					      <td class="left">ì´ìš©ì¼</td>
					      <td>
					      	<span th:text="${#dates.format(orderdetail.item_estart,'yyyy.MM.dd')}+'~'">ì‹œì‘</span>
							<span th:text="${#dates.format(orderdetail.item_efin,'yyyy.MM.dd')}">ë</span>
					      </td>
					    </tr>
					    <tr>
					      <td class="left">ì¥ì†Œ</td>
					      <td th:text="${orderdetail.item_place}"></td>
					    </tr>
					    <tr>
					      <td class="left">ì´ í‹°ì¼“ìˆ˜</td>
					      <td th:text="${orderinfo.ordercnt} + ' ë§¤'"></td>
					    </tr>
					    <tr>
					      <td class="left">í‹°ì¼“ìˆ˜ë ¹ ë°©ë²•</td>
					      <td>ì˜¨ë¼ì¸ ìˆ˜ë ¹</td>
					    </tr>
					  </tbody>
					</table>
				  </section>
				  
				  <!-- ê²°ì œë‚´ì—­ -->
				  <section class="section">
				  <h6 style="margin-top: 40px; margin-bottom: 20px;">ğŸ”–ê²°ì œë‚´ì—­</h6>
				  
				  <!-- table 2 -->
				   <table id="secondtbl" class="table table-bordered table-sm">
					  <tbody>
					    <tr>
					      <td class="secondtbl_td">ì˜ˆë§¤ì¼</td>
					      <td th:text="${#dates.format(orderinfo.orderdate,'yyyy.MM.dd')}"></td>
					      <td class="secondtbl_td">ì·¨ì†Œì¼</td>
					      <td id="candate"></td>
					    </tr>
					    <tr>
					      <td class="secondtbl_td">ê²°ì œìˆ˜ë‹¨</td>
					      <td th:text="${orderinfo.pay}"></td>
					      <td class="secondtbl_td">ê²°ì œê¸ˆì•¡</td>
					      <td th:text="${#numbers.formatInteger(orderinfo.totalprice, 3, 'COMMA')}+'ì›'"></td>
					    </tr>
					    <tr>
					      <td class="secondtbl_td">í™˜ë¶ˆê¸ˆì•¡</td>
					      <td th:text="${#numbers.formatInteger(orderinfo.totalprice, 3, 'COMMA')}+'ì›'" style="font-weight: bold;" colspan="3"></td>
					    </tr>
					  </tbody>
					</table>
				  </section>
				  
				  <!-- í™˜ë¶ˆ ìƒì„¸ë‚´ì—­ -->
				  <section class="section">
				  <h6 style="margin-top: 40px; margin-bottom: 20px;">ğŸ”–í™˜ë¶ˆ ìƒì„¸ë‚´ì—­</h6>
				  
				  <!-- table 3 -->
				   <table class="table table-bordered table-sm">
					  <tbody>
					    <tr>
					      <td class="left">í™˜ë¶ˆë°©ë²•</td>
					      <td th:text="${orderinfo.pay} + ' ê²°ì œ ì·¨ì†Œ'" style="color:#5a189a;">
					      </td>
					    </tr>
					    <tr>
					      <td class="left">í™˜ë¶ˆê¸ˆì•¡</td>
					      <td th:text="${#numbers.formatInteger(orderinfo.totalprice, 3, 'COMMA')}+'ì›'" style="font-weight: bold;"></td>
					    </tr>
					    <tr>
					      <td class="left">ì¹´ë“œì¢…ë¥˜</td>
					      <td>**ì¹´ë“œ</td>
					    </tr>
					    <tr>
					      <td class="left">í™˜ë¶ˆì¼ì •</td>
					      <td>
					      	  ì¼ë°˜ì ìœ¼ë¡œëŠ” ë‹¹ì‚¬ìì˜ ì·¨ì†Œì²˜ë¦¬ê°€ ì™„ë£Œëœ í›„ 3~6ì¼ í›„ ì¹´ë“œì‚¬ì˜ ì·¨ì†Œê°€ í™•ì¸ë©ë‹ˆë‹¤.<br>
					      	  ì˜ˆë§¤ ì·¨ì†Œ ì‹œì ê³¼ í•´ë‹¹ ì¹´ë“œì‚¬ì˜ í™˜ë¶ˆì²˜ë¦¬ ê¸°ì¤€ì— ë”°ë¼ ì·¨ì†Œê¸ˆì•¡ì˜ í™˜ê¸‰ë°©ë²•ê³¼ í™˜ê¸‰ì¼ì€ ë‹¤ì†Œ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŒì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.
					      </td>
					    </tr>
					  </tbody>
					</table>
				  </section>
				  
				</div>
				<div id="cancel_div">
					<button onclick="cancelimpl()" id="cancel_btn" type="button"
						class="btn btn-sm btn-primary"
						style="display: inline-block">ì˜ˆë§¤ì·¨ì†Œ</button>
				</div>
			</div>
		</div>
</div>

<!-- Modal -->
<div class="modal fade" id="cancelfail" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">ì•Œë¦¼â—â—</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>ì˜ˆë§¤ ì·¨ì†Œê°€ëŠ¥ì¼ì´ ì•„ë‹™ë‹ˆë‹¤.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">ë‹«ê¸°</button>
        <!-- <button type="button" class="btn btn-secondary" th:onclick="logingo()">ì´ë™</button> -->
      </div>
    </div>
  </div>
</div>